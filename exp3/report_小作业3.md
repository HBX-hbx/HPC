# 小作业三：测量 `OpenMP` 并行 `for` 循环不同调度策略的性能

<center><font size=4>计04 何秉翔 2020010944</font></center>

### 1. 运行时间

我们设置线程数为 $10$，即 `OMP_NUM_THREADS=10`，对于每种调度模式，最终测试结果如下：

|   测例    |   `static`    |   `dynamic`   |   `guided`    |
| :-------: | :-----------: | :-----------: | :-----------: |
| `Uniform` | $196.448\ ms$ | $200.549\ ms$ | $188.243\ ms$ |
| `Random`  | $1541.24\ ms$ | $1363.63\ ms$ | $1620.88\ ms$ |

### 2. 原因分析

#### 2.1 `Uniform Parts`

对于较多且为均匀长度的分段，每一个分段的拷贝和排序的时间基本相同，而且 `Uniform Parts` **分段较多**，使得时间更加平均。

1. 因此采用 `static` 策略时按照线程编号顺序，依次分配每个分段给各个线程时，每个线程的完成时间基本相同，同时分配过程开销最小。
2. 而采用 `dynamic` 策略时，对于每个线程的完成时间，相比 `static` 策略没有优势，但又花费了较大的开销，因此相比 `static` 稍微花多一点时间。
3. 采用 `guided`，相比 `static` 策略，开销大一些，对于 `static` 而言线程之间的时间差的影响比开销的影响更大，具有更好的负载均衡，因此效果更好。

#### 2.2 `Random Parts`

对于较少且为随机长度的分段，分段之间的运行时间差异非常大，而且 `Random Parts` **分段较少**，使得时间差更加悬殊。

1. 因此采用 `static` 策略时，每个线程的完成时间差异很大，总时间由最长时间的线程决定，但分配过程开销较小。
2. 而采用 `dynamic` 策略时，由于每个线程完成时间差异很大，相比 `static` 策略有很大优势，能充分利用闲暇的线程，缩短不同线程之间的时间差，且这个优化的时间相比增大的开销而言可以忽略。
3. 采用 `guided` 策略时，由于初始块大小较大，每个块的每个排序段差距又悬殊，因此时间差异较大，这个与 `static` 基本一致，但是分配过程开销较大，因此耗时最长。
